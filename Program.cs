using System;
using System.Linq;
using System.Numerics;
using System.Collections.Generic;

using Tools;
class Program
{
    static RSA rsa = new RSA();
    static void Main(string[] args)
    {
        List<BigInteger> bigints = new List<BigInteger>
        {
            // Числа меньше необходимого
            BigInteger.Parse("510464723937521908531837595969181980465411808505255793548555934578697724752196105703064110310943192728854251654412816586217063280865888040532885025183730907420656852929333962762098190249536944704781149129979405426535341990421277123900797667862956219521215508263485017074555451658474325797340890483938668991376776108556242701718580403375225836831501733207173548662027085904191261391646350781170953928336355499439676823597729868734844224036242018912981388448670562093638177975685566281100395239572572111787756493714116419325213412148350218989957869591711747072423790584015546606607429574448332257840510043837479454164725525965074153091700448287383628788817194251136336738812351803398146508994464889050346640831678846419371669480033134092807200420683370419871401239565297661080169978628987173506090462634539681775190897817763222940581881281760770052935718508918669178798948265544325868426868785974050932275335076542548318541281641884741049139491798760300857928799527249997508301031498721513630768984123033903466777679624902257330668347221036996747784879844882659378007631768884989208641955799854117228199287734423633326390404824880315777856250337594800415964464465439909392834978195503772389309482708602031440604188824015891614822349432947164603124274988382416404016262322420452514730548586487516808883259903954605010449621448763631991082681932650228078106494153757723897415001891304105816454637688665580102726976431888396937595642093304577501070239026913021744742501269553400275953594128781756624248058184950082760528873851156834072356975603382236643351776933289653604606363686077733648681981857202835817727740430024746956703858859503888600372028270496169143085569934824674989502849090637617934263368805300100450035602193634404381118442283317834697457998848693225698220035779216633699127256056783953422454428940747932688648155890567852409003891503838527801272640397466067314290734927849529346981843603387465130824233147103922792237546122238598545863389296138649189917390696336013988902936302852049245122295479937247012297052108482841319158305563458784111039998717756446962646502768981811409736416157724764622408714085607553063659637064839067376337964481868645647570646860304012005356936613665413368616493956947554976451746205795690844593538460149732784671486564153309853078284612892803815757950561733203508568776181082602605972149627948587144276318687099141041378279390997576252999829194850793170981091632461599433779920497072240438292109974104659337575101808890340901"),
            BigInteger.Parse("184302583391790590396337313485866369011625426317710066219319168421678334038874043794393271453414692569164227350650537794709234253269270127885309033555535671990701905498579083279528341206730275710310176518818538971762706839208432816296226866679804161620614596903863211468570843354155827847605220491947798522785966295193306651358742207807352098436533860080743016739249994239914104562792751234931736834054532621410704310834884921003752005792099394906298011296049812038236987436969791128845162142755180165146188761791318225167271733028081268525065441087440707700437778325300545279281039782613535339168873525281040514551030617513591773878597924741837606744628362601894475573064555143566187027298294713905559968378397163610851565916599256190410414784713185015941312201352147493352430881475907011365167981538997201292772351064662092217038521475303977973098471116979090128429375100748582463122442558786146675985305317277824326354948755411367573022761298850340463137534606394474524455589083269308960029957056626760049855486343107889996151697466214037747208863162517832784631161546006977400666367270828749128465860297858752461501946254239310259192400968407359787530655528272644248888704385984012482799047947884744768759081982184127039315972243258227896271222113265054061955628511363582833436871575058493036160447886957354972707042437347027896021822175206845622790907758023236194177637945840332553261533741518257007837500834130061094059865154771806265015789875418278431735625212073884701787306452996884373372044984016040042805397926551002476832609302882630032565924824638709304615665709200432178955239272096681783953427966350660622170768024681997394719850483170451003445217930501260200038732315993490042235780255121360876213419024008674446830501605907615744921259624724397068356743585345752997990534269528641943844586439735472326895910568041120801638230552951752016588305671881517675297748655978770915484882403523615749134937388673835156295153338027884387509096121266370436119794948696781970397648655174568674713065679830736408795335229655755724455739002892091015157275289198767553415645716700578016747855324475148797851536092550309699628392749924111381534470317931130177799308183608441122663900890767357029202620002990979464289923943373213836585566942391242001619139229448623716366715512406980854962693749056979050841914850931584270233644726007009040439337379335254021108829769510189167214451451041242491694025621096502058266344881912981059218908622086470200406723855502566771"),
            BigInteger.Parse("501592340701591909274555634657476176069210237444682997823854898084115034182949076116921387072776561860403473581284601500067529473757863323852624688048724696729258908570895142931414595479306632892382208414937771599803343184292831104966965122149404431267928636380839664024665565409505311425883797134068097686230276020256962376529410802821984372818258044233435346906225730485018919913179452925948285586941433122399901651852938282270762985733957574131245889996236682166489888186875238124232349851161841813795069433084947065616517760231039307199330872460877301891234984157801085199352610925925855621783140160822238075267225901684650360850980603015796850493146882999004915958519750654353208352366779421177330187977381123086806136049669466589153208067791231811029621422662992508332705293005955218476386101938142318495837523204821328625374386055410677543108225895821639630067748648719947744580425280279275235072919481857344821465768268632378299701466236851233238631666044403195427029998785988941543026024175319797862069909088441671853942960625827007771504220241209542574741625921895970993889275031138120757173114866341101067516631881625460884773771839379846719869302750048999934277737312284263765366119776329916690237022445627693993040491624806466461695076883333831176345986579645200387686855184133433214407966109248081879553644720291154081646000047416472444642348380004450760172472902190421503648669860629641602613277230522152692734425418791519389254151932865037468213986694413476564109586916710809425620950943463480368171198142791614575890461539202038573488790898146004130084818093682574646615182554595835970856750573506023711969514988415519581200598116775371679628479217476667788776705968855756824501823958263950541002881982071602284834721494706997328868327275549938835080833239041302742665029578219958069615070491401289354859511838209215842405997099338057260524157183829484639568643287029786223171999728126622096850985626686809528490612505593156630757735117058376933526504514412077894129360824541131351717226951324846770137512944969924841852023161289431592117232052861031680843033589234294674054307355726634390047479874854332672672952817109629075347128470640670573306731958086455159980101104022498916679286221830662268424807035267199783554584154839873265886421302846715267744704556746315438532769439625478853990699621195043694220964898803291368963578126568983601103053082891900023253947341614915588463870717626058945857227002151108665556593284067559328878333756729304673"),
            BigInteger.Parse("21895612601973397688851676471822625022665384872873675669363681242124792889417269797270117424778676970057272198596888202204012412153414442655502258727468264962022275536212672049879962747053893293434138118814515456589533948034501309766948306576987028844182061295182215248195708593657997586568183376588587554859459736530248402017824822002744129518414880191986319379116764570082881757296274372866329376824089883943630995974417285322746206541092123435353989856118797183469698269481165914653645960006774054114060311710614967718515917495961566218347045681400799566939550982491386249274950963496189832761794809621304141883342066238895559766126378086164465561012539960137845796579714763372231422329623698374524719226613095283879657146344894491455383830895892173900159598632206466619168648156053154016765684122328993592923990071680548186125713629420760236479104694385569677895735064462601641891786194792044007506549835974491181237469532441006316647981997266923026656541911115231065441997312697182398798450132713011942899673217596465637130561002636190248882306760140282639500544436713679748275228147180972889931386438557485812048645990934798904857706366725231477162056732834635919786752835581759246292540216869764209348514977376349925600722152287777405578867960109469320324792959050026646860509026829165031782058758052839479024889781910646326542165909593257380205622417576861831494073813765541287874969848508036641323916092236490674198358128957115132107200704449905086955953679040244555433927012362211412383522718461149114477665500249624357548773479727456997694084438200749890107845732400942840074994615005097120841374358343029353157643643050250394410659512327144733833034681789215042431123819732163857072170995706573658864290899855709278203018100580203502235656469222549920467452753031668344418939856394114899523319610679486763765191157649759114759017009820680297570222175754269195915424607058138030603682290560636054039307600948852436571167848480722555097558927538036264975325238945784801046461652954568023338978411209511992373935468750737890523395711041036054706086393394910881109797749153538454980533594697994126156100035661955914326072899747760626685341853122557478391118488278215993552362215149964533572344206828862100683515556573410702199143229577875269065092175468081553958990108511136469830048294508169106002743802801364595921136960310126059335565625940767985503201864177132846987981912967143230801145166035619721310963941416960378046114342723120798471726783268748223"),
            BigInteger.Parse("398456474328504962848068293509788700248928597554594889255858784566870029698887311434018540935072744782128288891499510782910507824364532874210241207293478253078905136384993628528797037468791588352634934131768184377707769652060136976132547320801155312595599230076462806427150592488125405009727774701360263145838903666717211408936406181679500398730753848274733555091119392286923266425462803818391881937136934718082568722957996298919453000329043312852505162748199678006959999030608659972348503877571331092549542875523344361694664997126789870644625625298486987297425088698441805300391386297799271899603285461386783393200740762285903817465819577325778404637704913535302719366592336024188307056956105787802146225049559513821173696114410759636616254224273861095309762313705884111490054246381662810326047330501366453471782568591497368593103987658654827712872484750547135512438621834212675718019201149802433411778294594423734950025388279192846846033187105218051751081928422184206732763417249035328934101117385362216595899072724255501601295567985222028542463931354923679411581507107517328971838257929250566701432596897930950869344872823607527958672702341706389304173634973836542275974940836899412403582702272710238677207316202686792500351238953273004433740627444645952007275559212671480693072730710911310576998970575937168229272099333027164143493910214121692248152101765327297186557073666005262447184025737176476351553390724878178931031443741912207019671874972524397069549537421437948048586821618794403494715960010286090236419715782806956812021218134269949472857851506538020568882391237437654071155568269259651823111440926345173188572202463413986348030477334353941228495230671544363911530110784400881765823693534319593945091264545848133411826184644865397988987720098541154667977430693962982653345576906072595283969549567046092968625492357915862110052550340558167380748423038563128374472151866421332918416630753544969604195343925966742063720956104007391591187810817402134055054301070751502434797011436585733260446334391675415938652849742821567147698510436998677338190734283253574174171327766537442061355903959653575304397629587323660021696983436317961809588111135510863314693100549817639556695050527953838792849518986457943281514896434862114798582630282682715499199133959845425407258979434538602103182702176366459341256607802158891623389983840066863955986363921766994956300007345539401411807473401523187332747189838759044811324435764314541248034246935610784792719867457501970707"),
            BigInteger.Parse("180277049663651796167217814486438457782598395312672728910406022251775776541293688456677652213944424718636736767624792765849012511164012312520901439964265193883603341633824534045476149784977586494609474377877528438893804366376506600575950659372881512240676397329980758743866954737627709608810625030570560863392105830841286344943625325613340117502655557408496582347631632351454358009444687419449255983989213746243101300880607834528426850872944247037194251382847243114962153261157949693626959683631866066208081090406196327459058905859327399363414167990200387928915605237592685781038119502559095982416957191378887970589752109516472666970704177974912053623424368725025508702568009508088108889067434065725656302136206932191829193671284182078309712832443037619690237261557320390129617887742541974659731876954001195503177533353368235900322599293589237422735627778609234417248380534148862011768847435961860181395977650190522374310109278976031336703931653245484813419005252832788770072575681077176339100525078239059105029308261190563412486897128912218466968274881138822176188129600021811007516221511487455083942725153667540930724142476463814317291536782451485584568758905364336377765182271471919503863490201884470117958366301770171759733554743807654190814080255096567347036208209759325912998556193649187972217829529008893363513918458273592367372706534028612780933552548751908159308290112771208110316836923844396566895542569662708103749774127885203436430569122036024377961705597042166277975498825486135333206269591355449540804982397699884338745359370118008321815645472025161063776938265593199117955729788269885382891036604919776805668147302456738296533027961911682711685303088296649494638400357030206067887525951178440474647380123557139418814374599764473902563695048091017724304913557898700291695543726141837139164205163816645150895613370760492254769282527878687518458703228703312051713539804090097261617901296255627821949933725972516852356680182841719084857469979843409216551353050793665442541655004966619995332964240909197705667257962716876167013036447298432361073071402582007033725726783199544434133156878153924775609067469682554508836490869759832263923605818429125774340632335368780816613693461518626055532708548317028333889574759633472866735487131567654836435957805579620480748938270811158016301731550077377579221279364861684142488386593497009732021110718849023549857504895756929878490813422545859437401174699720103986431978817689631717137965449167111601690941685791806421"),
            BigInteger.Parse("21578009397766731373239737346291723995744582336508335489937656893888915535422939403516716689794756120112691742384823740454640107432675921675472565509245908396884975757948029380662256284781893473979006849915899599374364799548222064664682968379583853055706946602854742239875632545776151864631758136933202246670044043554498790553086469900542527070731907924116849476423996396899272845904268312651166371768221982959193450385335664228418779793000494596435986316995588487391601259051313423679464440731153585880576892174832808244411176603966221477175799741101040353855320078790729937601020857979427499628354650443167735748431075926475861637571439945791184026353513066509285609607925785479701799650651837725607724130872996228861667648223341031063383045951395007227685538051727751985428484454922474683959964806653785998869434935201677603435022149661975522150209157287003274392848060856169674377086343325350138391162575867192250403498729953914965482454634877704869222474231084863570164710541346498678695223979364030086867652665208614252352718974836414146578968794288006820135737160841020857485899717875908735525543427550738823749925220608001027790489596855376736470403785206856154343028564433029392481854985079120815942715868909483824169933995328904288968538383285222610305347278375598553622757881219641714411947909263997102961229857468009178527711519647384771274931793956634022100725202339481939608717846402707081020302747263306498017502311176801984043970344328136211132118618121436822111811146280061659396878479965663829860767341836066356674259243978060417640285772963163686343297276443988624347778656367318354434730368733493009236526056378857521187839506063236459788996367178041443230916440667420979932950974964610602622118563217255122047752743421301314845553927396527851462920431451878364062064965717210538059841688123574383749811067791981954972618738451476548275866539881005117240639599763952106301676472152793638056038076553274267562080933271441307279007108295647432394442587985212470493327951432114243531129973944830818888970024309992192123149671956001236661470567997192118228082899987592971917297248543584526130807512521933809760812330649304255027168609520745933848107277903836460919360980422572527795640690301399989705290010992798508775184709467503444690919238900209898221127353647244960685807676588268279547488955846351896034042095481066612992650004816844545691750283836533266998546554826772503681383421196660871034121097132267726750316983903707941244565656566153277"),
            BigInteger.Parse("198939757950813548393855045878630923810488368639570417926043180279846533976751125594503417363687255573918391498377436060594029741545866866708086322887230859378623998278972302270501016467855258207695159966680960035869691433458801594470987506033821915936105417357985977102814167243307632559324472116797157653260564308170580569893359466172325067729013804668978196691485060931793328185513192886121871875210629995109557074026158498009816420208641703468839933268809230503693829653227752829815092981532865562768097676816773477914800301565680700775400537827483403861922225054383923290651450700019394335524537663662388348368363315170061813787901121122789949799301091773082023425480052802157741254766517887579816312515012660858783514955350822985997735854589143471233950100916705328580758482813755808445729611544512691874256474298357419792055875532713327009434988116302459347626462624771158729700078123462176675558433032154805713372583765426621561193394973426172923571298960241876860805149633587823630494304220341675910431293559228633536276782782977366869468483595219782894973690706456675706049255098541139832978090809758487084324227263546605487626113313295604601750718263981834164356468963835929425298318327192895226843296466261180851389454755053021881994638463194919341183924529166274540414355881842535587774660689369405975589221980066580155763193787173157911397597280606922593363314451692217491279179026201064380489791669502862331544558292126368782407503404168187039702064882056324938883973902920544016854506779798771571159945582741516259740129615821711701593325228784300327094399703717358656541789553794287752703456793224320458431649573714353526633579637475736128743355527710909369704748019652059446135508514609698364059482363103810978002074160906334778641288698339296706040668169645074232052688727145066665763970488630997284024007375069493524543222499040493441277547128245988281271905020789546901697428242036121186925757929233049452075005973863480225123435264015365173156714855257762343326021726258738988737916166307985503472066099424238966570975389986298072238931947028730033362757085679907354522417033064767617472426376536617068224315916729781230587992537421838368696731213444407000817697581368502420259421588828011404789175246840335433406248604504154062029104514897863325003834320972074390477410490221373158266866861260787038023103202338601035389371817452387963810969066651302265937367445976522933290655783090380459949145287612432765668566535534834213890609704885881917"),
            BigInteger.Parse("214272293782785573217483953894442509673683243990228192927048450684895490828447632327411098479171537190423273423705627713169224541326574110434505188832320334858632181267772996108611531387161088815986513720021994116194395983823961489544557040014727417686544605754074103485902143527921839518399099155139528665730324248292354773288706182294737276855009946193365849051957487155549919137579403318122572274561705952445033324355696143981108269755565440373001604183355003399607077150247328408539093709018836876982176056857373708025837616827837509345172952143049455629225648261109466132083218577039585667062651461667190751305889506111303522869206553926331375529705437769600148964010385266135788755604417298402631578428215978001908628630715938142034022332790569676307575652286497341871209147188115065587021301925417588639666735220410453921701455164856025952304373778143102973911616724031642169140397572964849845647038425179392135185637152446330324454560346265111057413623822859968845290283666657559580861915338925308726459447953553925118395386314325478593757853305297835632387478873753223626143472409391672683051750977403063764470904664864050031616092039942825861233768728711250015096097446690591636951416620880974156512930026316623931057995589501948095841717575979512784596338895029060728175138568093107716099726647032766879906207018510719403984935352766304560642615820036306511915799699115648258347636794246864064663730305638206052930312832201900837979830654752937036988676893118770293084541512675619312324225357879219335037059279096846383831447414868061674994575760997536248794607851245744572759972610475239320418159117217109260630841267300425636752101777243506187888904148550110842394792807308116519523704532998931677134850082858671103679416743857551013873766846675773890182267543253004195140600894357165411148621434504782877469632011637258317489895795089001287432232671008371092273773298114004734103062087261515601502048902991413091959696464256437101926423180117933068122835230200194975922115494415630699560951668447604951299366558266163164761671386843765752805985235739553778740881026524538257235094317292152655545566399965072931606199114804204746845393582163009783305830838828653577347344936677950731154306896709941001435877480729236622466267503657939513867743408869576299554731133338844466231094866097062172290064033472394331830734182249715020021784331230172011425661921208150945776563275934756276781876754794976604821939868059805458151030088974223334186791174617608251"),
            BigInteger.Parse("387927309489074953913350642858152542098887667801751135033033798123466930336587640781095739500135884753497381444483018352522172716619379686047442413954864187233361905259775501224326006353034793105341093060066886073633916533521386455359523941981252081002355221828178512430450713126258758510125117185346958117022198353217719008736304028712758068070017754635290184123781038342620607930863374641832560948083392135136896627211863514057023666196724386026444304550704995199009262391764596349164800168744912886386873064510544555371242347638148316138062007239287093679417657006613283476223188433575974732159490268154694429192192585509235363869990788580894901618591664811909333113390732600391424529235284849204709546398737082955693977950976264393022352627032632418483145615631642813881736822129561666530036033269537431783052856063727238126767833056886266264548927984788346029341551347080031710063012928999388019435340941209614449969479313301031292177752669066174033192109928710040421100835002655109953108040804979811187433603445567577159908368674661090454889855107517997386778617373774486321160126303610568891717742409778637653542499186656039662041236111084433292435730971869273018546937004546349254747601012447848612763306253590635766820552881553215694015657198729007025070093493621790491200639992259816654616394103820579262734439140298343159793734382910676163665247045204619573358594126187620754813042787273122195610740480930063246596033311323105472005943226798585876132625929200327052258790929771183061525658199825065073782607829784573791009946480087428597698220301702500927800814863432438250875515980947635661931335449888549359440432150677490532534425181755740824903861766076116964843199498115622194301298986294207032802282822642644892475237538617589000423474079930899904872514892539206868640699326535073758868442047186295204226042631440928092721274203221534170542465543138098198259089951403259137436281851319777561858742081180523333984049203168109838282044178754040598788143825121682148557092620151209472541804705578282521939447439938853296450001723850454101053224416956526949137211168401746451831205206969416355585256658430090021243287692857388708216376619673491953317179751714152460885683162532791716281427091945485477164278184513222703854172423151795259869181093554618982228707506907099110240757169248386970170563471298545690772761079479950582729302378112783602176364678718709826096912028600184230117381383134179100957375336885236383164893873848563964804608333580373647"),
            BigInteger.Parse("284557967060215580890577232307736910973555217090697975685866386255772538377883790378291872750403263911171216662087767019178679396621273936707203700123337689001982449677254956605435291387063989917529657283227336027329845444513118837494641343929478189884130869316054207328282875302670119951842379822527159899370542610617925396037950701202160938073184009920886631651403416959389153111045997306911880513789910060519594028272078203744285956324122036540587803811815293958059301593130890271162315810231746500693254431844092093723514399544697263106682864762414289247573080397541493112935260098535172836579872810299891468593518145054766516795965410739773770144245340860148283766350689361246420974125896312864396510539549941233053474463459213645535656858187148130048396821908869535091235291612839476984404806690186577737425393478277405508973670675513429801438364749907562740890528469510089324342432248581843518978788066733516806609823320548739854154699988611463022094211515892287253467599706846901861656297547388006958871895488339309215866435198826840647713812858269433027927563255368871650428410947383763481262909061000290650004262546120874866473569945135720209866594205633927298412418981434189427073163928088850845633370910104717392869310350123534860044159215135821864949585981326646908557880358320586552762659036310354998457133415982953948994531120106663236195526174652542007605820879740174331309766573710390181657901292904686944581650807888843860048475263151584174975067868963922134470729328792006032835018990629747164105441623607284922212942768173666509944239529330620119977143938552328630475658938768264781017598677456712600684135644162280670353407362706694516540632002705327787240833136682312511133997148201476609392261550673500847786085478133237961676564840715496904679144443835639063985890492992261486282975206340123151029286942825366741781051030727465209836633876526472816686565789357187456128755091455625587780897384959942864447177434510791861439318670950384100334986610277611914884066458440973152913976893199084892801731698892954128276543656050792694123268166289351564442100693032795375881136564497583360505687757206779199053332030346068047001660499100098536275775989738976358509722386726743183838059164993334962820680979725706109595919762501856864446413989208960110927790746296523433191518820528233145031730249109073421486396820332728448532554020609659288260072668734552075272261608926715924124297888497879587454432092612998950550477243052048339891493784800202971"),
            BigInteger.Parse("202406550785963034064160320005152252034437085339823374649098725106947818120882814802982106635411900645429697129817187426541849750962884067594327795988287707716241650413002898753937553713945390367978434893152467365118372489351495857396244636165155940792455539401885815641708233744863594621764239915633196033298231998126177906242772145254117806059927090369724395314104225473819540483386597051569406089590189096504505932755310710688909691390609248509457510812077602040699558877329994585221445307272814016764913794309331287272787751494733261219662562528047711858611966224466951715732054244490317601335585807819076094573981916717773243155447206832547870590333544243238410580780660911850613908275123006858787693407063123108719070117147632379365820868633343279630105664735722720358916406122907106142753070162533421752335494738903201216629870753145734021833329382205702291861853161349219393751695799064800107657539815110287240107248808216254176678389120678968897744375289089782641857874626050571095450776651778574097344658069819039747396373651551378921695733019067089492882088326203367659327015818659888421433503824815780788803608738508137756466915070951356965028820593076500318441654041996737385400526664151917252877881476200022878363610039735223044546534984029548754230762627601669072457242537409584494863891288186179963061726461028004102139985964088530300378889288048288098292337286194253728243884786356225604254034965152374818823182738548104005532435582107958973159419472911415874763313966541619777121765859623027751681064580272944672897085845344847790979340113142704331316237540095820396492153160722423516587651991241907400697621999333362344984576783528978468594277533772311615404164039147927603140653771873973349343207476622342404972659823921662793029792153619278188006498966314090842405215152225598715814211576399826762866322168835732189428295556841694245208286792753717526695524936244774988552844877395156986248233723065190841486254849988296405125361002347097164960026840471080538407737077778009845841892681775388034027933742524829344210159764951173728854387063052885506860413147028077650987646521759897466239318786511906781153045094999163267188288434332869263633213804303618410541027806692746812400453891312549857070914292000586992180145938047354712227596967794362207214504855099471805393950522712908142720769854675771500637044030533310664816204272602723279076406968220995692887479826162422194696337016617721381408057906362663750342742075817460808762281796825970321"),
            BigInteger.Parse("286688112285040644983503711522236330198795989500732348256750727133631594538410344499746327225251992367233092567264382739080582578155347859497754877437900225266534519232102909352196341435762633648027771031328096692434769289331080641496235155688186053357070469954928637757284209402257794290076101852413855067086213765909556936354202459062919226985917871027480763280393424627132590405559122657204026674126323022104809005408478489507739760550787124472160211206081791049470388928377090932396021280621122391082374685585051162790766480176376870970315622085340228374913606320511105287197832961611330576089627087351768986182493461302177805191374660391117079084845790866885587839698556790335829637429398246168392911755526713434089851814102114638164642293738732647638268161172091341392231677407965889014336996732850953603341401408944057819717344653669823733155630659856826551760837514234385949900611941862784414061058533149694938539630313911749251842852355444140543173609660652106889831900614792724203421018089229725989318351927140407354736722998656027456573204013851357464178956556717263649179384853248279913038202077230921017781206575465058171555421632856014589946361602967929846382808684418150193527645801392342347521447922123026993896873051715185009365325498584779091711268536118346081765293738572585817666964159113723624926157397060633410119771552525434137459596197103454768165586382925895778491961745947718450395799019145842793134316003445145818226241018427951843778621668702526485716198692707111024757548789316239284808712774171714697742794114174986137404474523282885902068932988367578314809773195313942827200362045394171352490777202800426365751783602211497169883625304543928782035845015647388633587232483980383328309442882380085990621928319039737702683154829164284579769245081033299817100077316000230539285929088817241544564768741855576326239720486079642711185800753370885805082720385561176902454073545640360404706930163696570892534256788035708367266163749003831816667148192327274893811230103834313590503508594702444435323075158587340272294695580579750543561576034354309505344213470744954762465382026935473075415343133378876596665667067920018118411909897558793215835600044761339943886229080606180799070319364763340657844505256622889430246764644548735885346541703435876884080421701560635119987446445010926781496841620743285891598313671827649564117282132502308207699735781600287832563399545743057553243065939701148936169804417708740256932028161979428844487683116783177159"),
            BigInteger.Parse("7783270906044295387446043453182829076767014414873354195320928295863944214825164957616549767137266832644512086595760337264323708730772994936822277878039730696799766331415599576226831359338929457328113338623723701497598269548607371767008188488768138283264815966540414909144992400534978979171985692080007289954337690384538524183145747829905449890206285186415176990420105617231816614464297020258637828375797894958465268740088937804871948296522200076385399815695266815257320495211248136472608242235399510809331441395766465814675602008663870682558313750509693074528646506068461169576764898427841292410809269764885131752741863579002017285224455095021798236247901069896638776911088671697740105064827652112817982488046268885075039851208133210113004849275160174876344096462273353930760739775044082398809670945050165370050581693716992927568066710641362013920359896545613414564888218562803056606412882077127533012205241525266263132740010779831237361716123008194482443228434104342796229941647144981992137991831715504879737779780288216269658044469820214083424265627859336289621650582009633202790964882509217670140534638608525622804664803677369329759074787001370687063203709952937874286747709310308935696680043857714760449983522333492943408904877977841261271075110809141897592478048279418485002349038509658633413819776861803931396224056912754670186827974218678451169352897933950420628286550423471354149655127268570523130565432659093551802592294457905500285526172500365411142352884910181319637159483494274049840747001779355195418981237442317654498089844524574742912726802843547065429914862248164941993367028623205077550046432164751305485314642606788459024954771399872949565668334808317041679379066752459958935149073472702976107311599025046267155209879140096009638607801545652580552635603474029428873043983207943401616154418294090226158677504002653139613444159273515366842313209656256012518903182945085564808628684721178607761799170064525672411550667981433284608672245491245779881121093760892959193391269827371906856145397815063329629255479185788755074810082317795508419546244421101405009441524220589911672203014329558081926620027222707124983812147872376397593484531201965456635330322450422063960377856675157080879583378789682408817343873035808305668943129827262044722874786786865612289455641880745575666656892350508258230399564134893242108380546070989899450727736909572865489013409845276876586575666045018706815553541647220189699977236976934977484396029342186523550628307518516417"),
            BigInteger.Parse("208948030745145994233269640046134479383007571550359511936174049960293604200142069316294390701439977760502475321169139530126847656497646065393754653879320407449384593016911302684422903087743583034907005687066267661089509144511173733388759610307508380873169700906403497068776055593341982784476369727506467648577732237191731488522426467992791118741765505948219458907809740415115829643110510481353384785441196433397970835657472060368523080680289353406743246249596396626504826973433902400192495950905427972996068192713532180617349826833498748826503471340360805938853160077357242937192402667738377077184921102822294150710619493797953299709825972092290527654736514050214220861805179029291277734094905859131818621289449011595004942291565965825440614868836051511871036915626001005712398332907733029186952460163377919528454425500725726497725443449540332821308624544455837837670098465105612784407185651575905473781431181044001060118098629940754204152527844780142669364230009248443243774483943498100146170421894999023487825800383961326426099100185952292369961547702404587305196407814815177623243000843426259176901339346439619567384707241138308413999027636795972219460820103324046595047479787769948371330254079470112961146942652149326621309138172125399271229307416821906086751959497530917635952063300135191205333746327048570345932754971512919834516262395486911100641784878928039880369139293577591491601371091132325340902434123276868521240143512036657389878640795765536479642461000689021786286217696182245459794237943363085278714029449756836184114393115950948275449735675337524790441488302369533374789271678265637111121867287620500728047006526522389809972390190929082772807868376765539723750838675982477760128117963371830465465073744130091795148339503519662127456165313935849748542927823760765010700769260039936236011422607280222268805667163982649947559621647917744354712881882409922780597960736091347484712598198323391970326924029392381526986168467918934733174864903263014855390112414155283134134315525281401262977761160654006571078225751893747470287686279531712754078741097897917075862621264492872484282758405987861006434752608595135590155326233983163465795528085754625946832568287318168360768946952506379185720639089543255474605101050148125923261950722026470208836656285861667466877953045527119026341941624931569764892617645384471289843001306561742730650895710300865755212225954471764150418347144013671465759731814650769936596978760454893965127198603001446498387520312423949289"),
            BigInteger.Parse("165111000673657229733321821407973533296342306021512313783125346902789875220816463559801271449496757668468811867362402308983561919549873966686382255844670100899755004836614870298168736494577687550561284496576420193249686858055831133772501878466364792089129203540483386121861201432649304581950623154229287612912598652976208106719915677430668582127524106257819385914832793889040023504337823657126404845067488196618911193794499398188569598981572856573774361868002858527812632555138590048928941048475650821581283622571271140549850946385162628030725975467781001323236734986457476448468414523783892316978405116305579208013185401660650066117052214836921704317794367981947206709659828619227220532788764007535235662020893345448373017234828430302096727961315096896805650591934393055422746414299509650521339109562230810600807696696128785292793806042960161390551703993659440628554937574208559972321931913665528305607919281061130357502805831862716412923017276747661985236769021609235478832176155611793394748182415187273800942975669686417724924732292272405086895239689825571381604119566274570551967377281496049482601283799486846612501981909275001901024365325469110349596196877640411769420495416619317504233452076236255501088827776833870330221489628469284550092181185902358252523012049062424976801456618762732777918220599058402730919173787268445567038959093427446937510414889243342846087644248154540791677178592520142778300303036475539299682165944148923410235686046690300191774909918587107563260176131220144275862436253954666985634048443299466331352270478698486708896894979408770683013139759238242696309335240807720856004782551950518755245960517181091796348813208295398471985363523714365768550750914545974889799061713882318381236227167857632353570288756658633361318264892826481279543353196360078460070576193558783356640965101868883589916768451011145148414387767189789074600472732056253622425705286926549780081772439983521201368215796261530185165276227708932451848119221738392232846329957139123567902692872135870248482918022677978586476104867965935767885595383348418642967645913695240636737072108908664121749126380137725032431650717242168632777291799791264870691271488075675899301904036596368516216712921964724554375904225491467481460194776386669455378334685346195831486292229071738901543738443150447722572594270789281772536787121695584941376232033602649352614778908591014530889600455085160433051422757045450065886609622456293583497483102710019800840697547154243133692962455405923857")
        };

        foreach (BigInteger bigint in bigints)
        {
            if (bigint.GetBitLength() != 1024 * 8)
            {
                Console.WriteLine(bigint.GetBitLength());
                Int32 n = Convert.ToInt32(1024 * 8 - Convert.ToInt32(bigint.GetBitLength()));
                var qwe = bigint << n;
                Console.WriteLine(qwe.GetBitLength());
                Console.WriteLine("i = 0, bits = " + qwe.GetBitLength() + ", " + rsa.IsProbablePrime(qwe, 10));
                for (int i = 1; i < Convert.ToUInt32(Math.Pow(10, n)); i++)
                {
                    qwe += BigInteger.One;
                    bool res = rsa.IsProbablePrime(qwe, 10);
                    Console.WriteLine("i = " + i + ", bits = " + qwe.GetBitLength() + ", " + res);
                }
                Console.WriteLine("----------------------------------------------------");
            }
        }

        //RSATest();
        //StreebogTest();
        //TryGenerateProbablePrimesViaGithub();

        //RSA r = new RSA();
        //Console.WriteLine(r.GetPrimeBigInteger());
    }
    static void TryGenerateProbablePrimesViaGithub()
    {
        List<int> tmp = new List<int>();
        List<string> list = new List<string>();
        for (int i = 0; i < 4; i++) tmp.Add(i);
        tmp.AsParallel().ForAll(x => list.Add(rsa.GetPrimeBigInteger().ToString()));
        list.ForEach(x => Console.WriteLine(x));
    }
    static void StreebogTest()
    {
        string tmp = "Hello World!";
        byte[] message =
        {
            0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,
            0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,
            0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,
            0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30
        };

        Console.WriteLine(new Streebog().GetHash(message));
        Console.WriteLine(new Streebog().GetHash(tmp));
    }
    static void RSATest()
    {
        RSA rsa = new RSA();
        var tpl = rsa.GetPrimePair();
        var N = tpl.Item1 * tpl.Item2;
        var fi_N = (tpl.Item1 - 1) * (tpl.Item2 - 1);
        var e = 131101;
        var x = rsa.EuclidAlgorithm(fi_N, e);
        var d = fi_N - x;
        //Console.WriteLine(N.GetBitLength());
        //Console.WriteLine(fi_N.GetBitLength());
        Console.WriteLine(d);
    }
    static BigInteger Power(BigInteger value, BigInteger pow)
    {
        BigInteger result = 1;
        while (pow > 0)
        {
            if (pow % 2 == 1)
                result *= value;
            value *= value;
            pow /= 2;
        }
        return result;
    }
}
