using System;
using System.Linq;
using System.Numerics;
using System.Collections.Generic;

using InformationSecurity;
using System.Text;
class Program
{
    static void Main(string[] args)
    {
        //RSATest();
        StreebogTest();
    }
    static void StreebogTest()
    {
        Streebog sbg = new Streebog();
        string tmp = "Hello World!";
        byte[] message =
        {
            0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,
            0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,
            0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,
            0x34,0x33,0x32,0x31,0x30,0x39,0x38,0x37,0x36,0x35,0x34,0x33,0x32,0x31,0x30
        };

        Console.WriteLine(sbg.GetHash(message));
        Console.WriteLine(sbg.GetHash(tmp));
    }
    static void RSATest()
    {
        RSA rsa = new RSA();
        string msg = "Hello world!";
        Console.WriteLine("Original message: " + msg);
        var cipher = rsa.Encrypt(msg);
        var msgfromcipher = rsa.Decrypt(cipher);
        Console.WriteLine("Deciphered message: " + msgfromcipher);
        Console.WriteLine("Cipher: " +  cipher);

        if (msg != msgfromcipher)
        {
            Console.WriteLine("Messages aren't equal!");
            rsa.DebugPrint();
        }
    }
    static void KuznechikTest()
    {
        byte[] key_1 = {0x77, 0x66, 0x55, 0x44, 0x33, 0x22, 0x11, 0x00, 0xff, 0xee, 0xdd, 0xcc, 0xbb, 0xaa, 0x99, 0x88};
        byte[] key_2 = {0xef, 0xcd, 0xab, 0x89, 0x67, 0x45, 0x23, 0x01, 0x10, 0x32, 0x54, 0x76, 0x98, 0xba, 0xdc, 0xfe};
        byte[] msg = Encoding.Default.GetBytes("8899aabbccddeeff0077665544332211");
        
        Kuznechik kzn = new Kuznechik();

    }
}
