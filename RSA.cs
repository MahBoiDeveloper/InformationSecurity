using System;
using System.Numerics;
using System.Diagnostics;
using System.Collections.Generic;

namespace Tools
{
    // https://habr.com/ru/articles/745820/
    class RSA
    {
        private const int BIT_LENGTH = 1024 * 8;
        private const int BITE_LENGTH = BIT_LENGTH / 8;
        private static readonly int POWER = Convert.ToInt32(Math.Log2(BIT_LENGTH));
        private static readonly int TWO_IN_2K8 = Convert.ToInt32(Math.Pow(Convert.ToDouble(2), Convert.ToDouble(POWER)));
        private const int TEST_SAMPLES = 10;
        private static List<BigInteger> primes = new List<BigInteger>();

        private byte[] buff = new byte[BITE_LENGTH];
        private Random rng  = new Random();

        public RSA()
        {
            primes.Add(BigInteger.Parse("273580382292048931839212543621284572498880927553220903194807290794418806605668775427847417262906794454085728237802834837217833829500470944764792294620930702118297408577363301271494773120791433856947359091075773829313418381306125895014662892338786394761363087704957594952878860960190942963645652869194136421086785244548122426385366721795993667796292326516136123525223918885867979857521636155303753333652887297233836813074399089565186213784348374684996685362362904159451566852627679423652792130553966365268676735892552022370380438921485883734280268622104533414784210338999487474265235757191191434199545635093608247773985096256276807097346707129198954575546230789398841723182436574634412043241530753117128526191356891479222042803207708499980863286985659753556865368859292805907189374536055477999145779211636621438945493694886955594192507265547096487076371617256064317286723695031514862629654111940230909775928533587385376912001999429034718485434270334781719676672752635420378121273481008340384763953503154504808983005802087206770515776232475419734500076646064892867012469138610608159236417389185751358228674291614230407134631926905555387644627274657682170756581376618673640591847947011855971157954431334604830830955062484233057533813942341883408905011696528605405026253250421079854478242281578910900285763505154390922324137095035407332492895459617593871847225727184757062063235777142494065036382847341488987837259207194767900812690039238484721881344718615687356808645825317577411666202900024243570150065144075003317816708397259533760159355257370130991263623335391494037795819693877931902663544606349679884458292827647320776475091454275237186761784053239487603977037784096537085847249523908407074113924181069322605633137376898886442109282666571113851596210069263129999692603268397402422426423153229935725409419047995459498704110274470889616748204849097385533483628699811851361604944316425000130163069322304521961788126591749795658290760132412000581486661059860456944064247969475694785957330494600429938124775868134711382383194906955707810922951034842445878974821304642232302740894201498866843911000921630136382055784855766837423219277309338959952255199620693125397123184574822459212200656527753549188202920587326674091023310064221019747234726311926478595531137459296388613496963754415743794491604012124582058258419534453723736637014460478205790465393463359031667692931146203360939415722721391880188685802880699143364615312969188882839213546006730556648678403322501201"));
            primes.Add(BigInteger.Parse("212824693689591891025823871907918427545472476490758498187409715848149508897542724793834796295203025107035815846684061682386042775751221156921916287358318590356090929686647404392049656312722186676514622362058722066232443782422389623822229707368539124181766129831436306017181388366941194151817528696856912317690346546029141226819291568939747700460727964956092327059007951129762255514364391590738723921850821791556392867068583598392587253467606388398902511962059889451090325334708988177429261973669782145586306689105800446811406085091832048475838556178988227170013815508329648816724524815211888384467066228724889864815748980109844664180992283989397383390943717504714485269344482719068359621279770473293229307044435241610595013116804698809469031141857204409026123819052760738765356937936451496125273820303875536449480998282048604620532470935244044101546251877102630201734192480676876519561417267229729375925650333426870259739468118922651575140549650269214204486502957801779555570617362983664626535510774593821702035485694269400501674840830595191471940130301553619706424360232188877968019659556560413373420397406763889935817506459915166897570068315860756475837672140837778218100068592084124639643896832051426179932619168721352567736785386639169010263862921948412665314259436411086521942423919946028083286935459685457386857965918491696998560374979855640421348495265398432680697487195806419333910156789563538684018575946640146599421978955339771581018601450216208761613752759381234000228676532780772946571340978652019070408478119959151700962229670818695057233128794099451678998244588031674748847183518354681467720973009217065202436330770401597676137219823102634790829239609739621194376243534958338630501314608895920417746205801837500773557480622544864875658130830886242642834036617309174579766520093231405069919812682783792930202777553625193850688499536262466819151121776176462725575490888784324603651121647591140796433156531069479452858603319251539309848977301897056519499896153554227190376272228699608870954718607660626705851173448401873094674946035427496659538233413443381604592007867613879908622031171589338787581924347995859029374715839656934606131747549720174916575880803027215053463920518833192614000924531269204997973388875766138087698568091928782588545027052927053673388788808941998229950023627704924107818928669432448156072508077659859503099651762270253037098311098236877964639786042410815678932726720342658850519840267464637176694233397484548387972738614501119481"));
            primes.Add(BigInteger.Parse("336965774311221851930856724946193302889933016468309982886527760748750541567020745785319238820329195260125129063514832970299360630433377280997331782097215406342928458734490988269188856337112742427914934505083540587192810346101896554788083057611228022774485189205018319234716717862103010491651210474754202400463456547065341891174514306808791575350585586800596993889992009868613826806032876971764122596185568415692659496363367121955964611999387162934912795113769432246948265924909032159138101463386782765264335901471845587073022964096762982993270471877465072466423091471836865860608101382023581792572861546930905809475740772484246369517892789368052554104534487772078779137815399449301486837728450269754457756948116501136121886357533023527389818493963106504771383214918337806134103098337269377730135448880190084423305960962787576595744848034563553379922309928941826735394228227667974195321185499056832497839551323805994254980163700763549068928377074652666912563741517256902058432255753332181685340466491856955553345646071492013747036685625363111943042058501029148282283828421655233094268953731216632314502020813950822311268563680934975371077092629721000328459710780925353334928849227910888656729893393187698251502658480249943988878050384889988534350371775156774302682614260184188269558629942961814145697204352822666303704551793618025654963601440420594681359506143917332489844353345541680907986503346339769844474792609046747888085027272714663654048214517829710173251905818387945429743305440794839725368896944255503310421443846666157272591782021894294788260989512250378934798859190673066897918961774265843724473700069794999026100924760285851465559872482213486959795011127485332144700241951621777707526830688233241751713494169131247886093775249979925943833656408733418562112638616959697634331464385364091072783839913042927909353593093336409632756374621322147352377185915629445379073016083613397309969791637148815472135157384224417783306239956070886942874907967942842900970921879646870890314944278216368142745042575536512253024023809607996007521945752157227188544821820616118511616169360279415071262139308479265897594787840909141707888178084129139606874581410609000627655913007887696264428600788546984521343312476183440443340201073999482582294581030276335468033168525210504162222014769394503886385467044689818133010887436953954412642807825156253612521021362645606372425771724795843680757295946670837139961564201351537680424821718028423545735184666466496840771215765966587597"));
            primes.Add(BigInteger.Parse("457991954451273422333558905115495472067691366430914726225418686356134768551535716990433276385863139328204588761520770522206792557668514876290746455945208282044726028445046979651587330181688640801877668552590079182420740751717423737883756512003629505345286544118940522894665988213328556497597949554633568723207415585056332858716717471991649405615068650766996389436005456797540612809362581517954291655900304512583990830311938311370035905606448706315947639848106924806739070245803560368554963409160847906390510970466124795744631289954727955487823719391057679844819611707474066237697067323322611215644693886893234997568697585046778645778159454710083057455043179938888618479433339512236582333409580575667897705789016755012269258098714132926271705161522385864535392754382527304634200524925636666679955560124165289383680933653032007388432068031075410568464528914347536226748100740830290760297077125995289843630412874358892907522037390460560157126699385787847295798349580582302820772982612004458633220282673127928843738913091276205848260129450884506121559263469980268201332414991505470336748637690860947387515816685492551297299563740804943149882532589693138712159747583091141874997094492124500826656989451272852942734002597005428540349240116753313577509217097938051054747026221163607566254693712952960916293573331683494461109696670749429215651466830263222748979101102713248172407635991626722764010116397701646693466474682441012579273276301634026716817314525435837573019893143205341469853372221057232769907795299294890726322509641564714439840374557069778422607457644884922176747348101586682241828923871995290289416144128803398955655428684357097933964814424667869933198786762577342559249045000667483835800055193211865773621739131787505533055272690185735400651295563492735369312001815952068781599285443639697849097672597470687763344343393142751998991459515159262078653835101650651293121897865220345210250058892270020128172951013510985192624613648077550980937911661106065512276722106177492341818650366497816000419075212842035001700838028444728280283684288072018829050869027616002786814369891195619761519099294632278297682580131192345808519737578558034378944508376906311724471755694837440576204252823092812824728223776338527761503725661183949379047555523297232587499289389874180087112204733044469065590052079826683198223634049017853991890776816753430245016744662450768680766453357970755323331428982726886560010259301342824836813668492620441633727899999503907708770282704243464223"));
            primes.Add(BigInteger.Parse("377460029351556806733085213683730529701532070702205435410589377042551270783375433733253756787389940419500442031082187388666251820016120664721762439544303634367340438854781809141665247685910314344964867166614341142085675196690407002570117008138666871397128719582256253892877306282694327860687840584523932077146822178665417059501221730229785550301933243442898212984281951769224740906847731906239700256363486501485824716294360713395562696777393615782227407014189119334028603134118871376067421404444026204398646734584049884205198960510687375367461251881536790401717631919112050601080021073976674773878873180880415560631003507686528028277669432614593951306560112040815196601376293307961543082404871097596252232483588092956314802295655488440720666296390375050125525335465418108836872782714661679928371144162606472132164881806279946407988214496228976357938390622079238357066608030373918640479040062813198047143415345452578397241434958004478343774300535939912747014926800378348484210906815290554401054940014114247002801133283936760339443505305641732304869408751921893208911604910554193521900943361009940351434916990431393317022660613503893088606405334622358300470241712691215780350612797255368191405802322003786568489809442601994630578477358464044866258565253227556750782941598394904912877053944660844719937079976149218830056565900186506229999996789697335260866483815937647081463660117064592569735863008131482820262618018328766979939345520895687328183226482936372199038127694773084284299340062377931661322214607091313384927238625275487189594666175322089587741674245799614159226019154101744466425658006324226604920601359009995190586688062417649139279009068837114861849198202033540584174146151536109904413085896754495234696148968235910335637719421957304459573597121957798774978130778390383105480037113345555942076752593620556382518950091684774425290054457246677357006634527379744905896897621939984175090813619518639101649373220638731712819501232298727599230021261562604603146980057692360433922200970649197752517396877696155919809208491305826922485062465743185337351157621028536074298560113125311747293589574367151480884251381535575750782670945984976407153184777763802229275056559681574604833979832220319621009872010833962077938678562541391208748033446165025501475444349298898796745872994481138606990799525762870023454155658157256322651368068831526976737945476765999986183559896848662628499744725763198322555746292441738976543901433186970724952658919438336651081277520039367933"));
            primes.Add(BigInteger.Parse("541799144304369671096842251872753593731613791474108395438585476358775546126803684971751904170912678767406494053787186168622036596511261785453261994000051746594754168459220508187910859401804554444022185004190070187276600950923594527919089702757096264762058431162665087902007107621812829878443211485135727259935087398485883608944911733741205670458174783769751806876310534059763712235885586046131636461912595183077064853133781037952338579394346193110180780533483373573757975552959243905488977556503986542623384789094631573376733798591512436524798383331909631027393979904089610049755307191332657538205106569160728884559887816872042549793155078141646911921886953556708551849568901124015992877969315237867714860595028535230119700239324562091796835637163555553034859763225288084237079344002944847220207824197443426507741498128304663725764477144216059708545152977095042916892365593283751754844499061895385253443991775177672545687019420808533719590249552416309225206148594699556220778070222959053102384603502240681237116411864839946154431326254247951285540575367588531777198029958754902186771591059675610820544828226381938974405632889548573760125014032658645041279346116461224230281226584001059701742561323034082980406191667890208048722040104861741261626579467427837535426916271014984432851221941595305650837361529736361054519780000111334836962313196416420299915338516224719524007158410916283539885631378968440836306889094962764949170472754334823357823857924160106061580822244750865315772853465529281406149119443885441025337867878715242960840900610688680921394717722100529080658040461875004595197453887698424542161420886859230708728503479746483015989936947462412381158712168738194911192401157031938590480408817990594861416152601385610618501593093673284839940596440648034192027750292668102407523685343918426872482097614203966919270301658507694534773178506350213702218534053396768532142614267297401123441766079082363956349349535420989809721283113912970792512237344953273481050518687590378453287942073311469704938019366468052689290900773492437282036233067598875684342275910286090634785062599377705244215548932897224632241256083155242010109849750143202455000838122132931122662072233607779138623653029445259834492521418682044174993029862612423086155767430508706972748986947030344498022657204141272606045634823063065589667495485229008808391800117929317428529007193368695655238656091362720426252540679199990666436632816076119004187155765973628287730287791493275548666068557996535909"));
            primes.Add(BigInteger.Parse("11829994678086012519879700537569445965862749512413429956468610626829301536587268879177781892335328336530114866944436334391759292103006355387130389899922238152406650427899531659151062391079202143234879463822925029785163065401888955940194059200552482865830541291152687926340894279771232321462318510398206329171779459441238974200157779973524324256979556454356377140528382523516051146864766868588545409948235482062581228627293596958535141195004793490672058704733392907595750028281057692683889900180135534424679212877102805378844398478203493876383787247697832024504061298471581895018701675519856140906821250077721457465868222880293154228144465054898655778384289766485291982409035311001721305903029735987063044915766278261783332583661204722081346418308432849173260280419983022423217720805602577508216122606875462295801102579915674943379920816515628954303061662176025263888096827560805610661501038754221213918474707942845304187242344766221681980995687919409904593244565122686038347336934354081831194112133533444206970697772662708135804683805808526365519573228104281817637219282926709924370976818885279102040391451343334422604126370873966139629690701522203395530732348949359494488324540422992040738151386978303630572181873899887278603108025684658753596769154884158194727942050848514799719658392177250985630119164491975488524828494049894238256771944540296166735529461186254621607232068918670464775446894510489686612335494338385851094114079259948741236672328614914451518441855324241586887466432320863652051207773932443708606250344005732357886051951993991439754503275210602165157099750257902024089589946445685355037017508433424116324637946521845578900469051915742235641714329403096655791837494405933375411355381358788532553278282750599255419744689028813440308086836901654070465332542466707986832265973737590299799694485193450492463540846311122548087952526188720792059038171324622639841818879842043089996235613135475859800876774450687820255727000785932895895353773820391582681617910150338875942770489281983361063937731713470823191793381616864548574665362251072328693433109500053228704881632562628875848405979315539236240950685049506270360480111352460697742183617162361653057459264762508755769278710617587219733041747288407505913172747660219217642630146474230713912868620114314843517815730738358763553426512315546514742413105553280496933930440965070870125651460980726590792905900458685749908969148207090322519696842736414317589791470502163097304435917313313074379702712101206381"));
            primes.Add(BigInteger.Parse("103359515168718854661118398390055198272509362481257952130049774691717408823604870868030400983460393646774813153266580041872329316543490341693314442292374963730860554132454966815107524799583529985818231752235158324014315901019951245020161589950219017130465364958987199300459569761036297852902705757178783626555045605574432559126572622603113156128744456522504283750554640246746275861267323711260593869314715650174303628895493563652181847228367526146742149042139432616052410037463389516009405601314669735135660814536898428525906342155502267220630018728650508993296808468938647279355062435469052157928176965031394668036131769043688794469311236322573662755435285777132315831404863367717786247032151977394181620725642074109263705138453037918496728906604579709492030278537664826306733948821338009314838272772878308819159182443975330859252718338917166491775879370842000542392117308531654407266171242810889306620074140874220166969639269938598321436913366398589853788483889020140945441646835962001248348383345013828131768971716824590678861788620688365142355790040285432743789728958389630070647696169086027097165002858659049261902281309436539757447041862045773447357499124734177186612946577898176741849947657041835311669796186704662815460257910072642141338676813090881864341571219468562429904390955834872083799226053821872354239713889663904887243132858289809031780364465295064676867016492969986042515195988150080175249168743618450456314016775834432540615927219942353059531684714826519480304270399795351291653448675726038291614709497900438962921488172658786422180418981849921503405071564674562589987195836058222968525000646062775285084849005276727523839512868430000333876682403047866800642306513544690553430029827199602584705236610388962800482213662664163275662101433423997781987945054558650876980969174563562721181320777756903773140083731986766912679918776965392931428242429132214994094051857659398113978134888994585731460173765023673819606098620575957266603737373857179483810576124947587373902913536475985147556669853078231671046564310130997978658746228041194826534750786409666488073860807435607355222472406105073300637604485453606694901855155640712674486504533640613320249445804369382075350484953255390174651923305191516289459730026305437586751253035966487903180182615089100003289424326933370998743775773825974178917190230984726920126782139596894311643763526426531318424887740517718811583586794759755830325993259260135544286131051342363143026925406139581319049121963526850443"));
            primes.Add(BigInteger.Parse("404957002213347036055179333472669557833214099739769496527214449081708871677963552466480645471157640146016195758500851154139971543347469926544826898389768669787560497747139703270171339918858362592154033607583864580432600441302849999471867609233272915306177512827719996491357752598179815439226716880815083266816781910348073790212453576468808092562490234778965454910143411341532985539316649540999000731675170399476666114138314278128210332262788894819201352218461009692430030216782963783840997286604800441596488435343381153644491518549027841949667436970440982063776034330909309458091909265144813462530972027129396865752932155331179920264932261372402832721365632648738445227431766500269303727142107178700405171908101878168455449079086598110846405725457142825358042799031685102236190699881944043384139289988447125774530666841547660807282921125891525991404280392399308951039844191934611937222054749988460454954346699695665211622945443888714445999375082395921490586738346744731480316956439080091783119982020264219340281460954335807206503924945938187190735132255856096702617908337017005360444961560877489731307552080823743373997153291651817224714865378536157504513366709893993356278898727856025647232611886889955331053358810484624601256686305705146357185248333661183471176248430567702819749637370844834722260326516697908309513099761419671503011839710431579136294480144876872445518346660615776797923457899298216917959390055689792843848331999059245784037423760082550268136911924503998279225552200291855631182361156968926680944479200546560326845438935242582230689140087612325419240174602582643935401016867782153273265359257556926760158207298241356549548500470633262212465651860963997384748907256354426453122485082814188236607735347051119536571324805281643925328905775312622795316048958175013186670322016044692621513694727281044712179983990377415651036906158724698633216900249474983498185275326437938769218519354699352339687511799731244612839632465186172369060827177616240277772605571358294366314948009505132207225171567721129906113180780308923208129890889592087149222991246919011198184101681305014945241704200116095476945816097951817202731327823117949998651440677655538812592624340629639190069181675119243010017424376339439922028429154567585151851871291131128967612209559932385882150915776798296790737719954364605589157138958129477366183434713645340472261803128260686297719710279080174615325037160319451716192704798529136099313552410261110853479182710288594231255321256089492867"));
            primes.Add(BigInteger.Parse("95773198862763353210967769724092175783211738351088319334477562916271038168494853793916871133449141951857332356789424904401000627596037247801844027347699052625119592611030574120299549090604263822277936502104084325833804339787210329123182974078462199376456562279292825053823153293730993353631768326378115958169821899006186974727410160045556608540400965727005772244346839328348986287123041649755154467820911540272086445946188373264238944077320490236981963523446710810281193332089682393556101787547445371948326210078523360824325970893501605438450619592804028143635087659956230789515234671153694996280509328408555116907689059315025734088083220311003530195316109526219473871128632615929889745602558563866759310599126718879600341158385667907449046395691657020022377124569636818292629707313811768229068707966868422351094887050516919141015233306151303077301611383186142652030420876897532531157194876313972192144863846881492773987848182865998562911585098101742279740702604668875807163651206386796738822877809569570582407421731547752326411322781801371968703168149751181934134038616721641220154416154727151394958590189541175682225086677468620061772584010355047218019246205164520330649305534937814300472563603671070932835234556306476520323887561044860843989710497537887793699393907047778170059175591872439788580258744332820470556065330277037414310995306913706318734366846789419158969861279244855582883353995425320658808084925040827281958668342136381853563386074238361533042102556209713575407345153179977428198328282974066741162038043184036226565879033507480470062101773218435261084101967464508257514113109475943658061495028608918661920509727104716869423143168491801350438957952869675663114673873685014593575553139301315702582828863005719670308295644973528563471295167639582520936627731718372298409653778278647467507303558708100064091950339326492837550723416107176393537282147225075635347694450193058161348313356224500051048822893643844440112492562504409947033090758909602558636217677379641769350229835540997207027659367744852488561532513442611031900080991308761656372085535416793657863112136573768636431732603186467518778001510166049036101089059031318099878983621682083671759841132175434819447287251776998564239170727825527365967821593367689970675751770969951371539948933831264391910580943022390677310199818247957457486190421264390705430786921312066407878633020506785016094729112812024542613723519381110440309261079698409380579592820225068056339290104726818976659355036793488031"));
            primes.Add(BigInteger.Parse("112288012271889518164078153771559501566210064472186225873882250934894756489293927033675925790653072042464185406302586052050742693919558311669804110640753026116701751344607768275819656206861110041405651925808840490887644190549451482682496888938516557127758849550329090585451865879078973021260433280837177564410834281493366564604428095583727557349503676142471225662972632442596681663168715527037905382742679539964626367966812081471398666227587305654863070182383419362672171715234119221978791284693947149819323509985691303343142478598786159045840427804072588332088477589749266590018489013759279475995002259415559009427664277259088818747940236719867875416577133346924465717159795774887094296049022281243436346216669671008888689842706797417424473950678115408036498339628904296241968955377990102465471031655656618585278569608842873453964981671000139136678654663466715245525863042499526843611344455179192114777639943986916107845624667516082131197201917795797084468897877961479581134557482450544060896409692766515338517504670032114483162239739061772328110417363348232375108179173489905075346745712887884329652172019774031509208019142159552159623689220148358906435362843286556575543387254503723951646477956251155479900031492655802013606134207860046311806763194460570643122731489743254862395490000682870936603242732129552646764298404373868649859231966590002320460581427545849290400635554163457097853842799534687225718772370030879866609935762570117194752527071365687992559170312922053654150281862447209081073062692148205059344020724370547013247215561763551442277165876169108881288499831537012315041096826442516721814625907244475275842304504950204476374996779842973095989856136414865175973347252920766200629302734821577119348905336886494890091754225545599750679314512463098927667388056424010184210094318557672860196408740804126363216841039909671240918884163032398666386237208763292525151731378894780493428894773530619651681789460672558539395567650063162555327206792718127229214642556074737232821921618583883676440030651282697103263278971823208914377537534873083796759823266682991032252054360743130452743342094898633069937922770977448273425736971754487475748210088553027932653166466633010320315743873237202761853035296923262208156566538925943102329758892661152113538685496680267686402576423968145647070302964307253074180897062725996747735409860476354564912780985177549141789071481566593481676287924663910484157756842649685507764334965611482984593829856511674359640941433559392311"));
            primes.Add(BigInteger.Parse("432656441779926843399581133730490109146975715313005724558097024600141266714263680597364077142707207281471607069661054662132147315449057956897439058876027351628150494767843074405533849868374933164976804037974120707288908207764637454734092358497319457768542192351783708102813836748603728251944667444096575124839430136039345684864452991877657937105822673020602463315730145885611465082988127083738899678747161700132853966908269521160503754661510493724210068320562178516969668480982778923302365480154713493546632031679079691642446202631486436488455059081005301248637597426438889194965575431727291629120912482474335466435656025881419365218791043226323794535042287468789466348709182443986229189396783394637787309353436503091675964398873672527703147769466505211034026051598089524912522798688196598323016701077841700848930336275592443485567528400982902575147169461950636240164076449578727087067155114432054355347609058645470983245098685087465171276022453304867773579344280940024525236662516550121862678694580676780089451014197869377074986766570612799307828749169240908788062981573825742617743365972391897817922482291154587271897647341115829882522756821836547227913276415850486499840652540785840841954202575515321386106169248536858502407652096676145737882367252256951199881953417422787511168461896273281378401644285376145902488762741932648122086886708469428199659441875113631133862911679942235794894421895975270660093793473962436721510182632697361430646351251945817555516591054328778866180315971386659594947326936775237374176874887760119592498485583537046646087267128911780679494982234068945434285781825540468272064153052047167288850364443854219854162018587131358270318346631733909512463694036602555180154387228892707727515515311068155965642510995260616742972787786221278332046368320948015232668783803034184685554535215690829455578088689107404589797898879232373032934415231869876076504802721294300078211883227450165139729878225947947956937460155591816573591750947737219102765940311276025067316536832738956850971746455457926394870315874111331182824660059338117471334678678967214383376193120477963917251695846991403941892886501713255168434626525574707151755493492456552894587521719944686382743833631008028462541852187378179385642399065230205694693765708502189442783799331365530517703336400821274844354976027999147461372799853165401261512858374836902862931676119837221923117360225183454662084495984110454665128655563028825033158508057730154966918379842580322953600216970209367397"));
            primes.Add(BigInteger.Parse("515401116388153779174620858275474140536492359835972090188803743048177780733393566768454013546261970367861884092085495240430122654730179292423875291150952071752883823769050685220871440605822692227380817463945650055824037193586904361531546615007609946708683219012634576593762741096118188045080393015541933498755286581085896319307882042457617144350546279599853297844786235273224026599356601818586919148510953733667834677509020997686415494064272229180723828713791476538198083799779520253988077214009318419613091406970339202746266776092715264764058195774927233093830349565347088547430017905422373027125063970102147091591972931266525617352130397365704148252256233054688548053500070498696171052220514050036675045635767797950424687966064785095648645668163947060826763982257508522455514724951660710798115632469617299840271176910472129687404979111850442430206852681993891867910145935128727075012775538148000185387346064847141917792152572484701340089969426167457098368366076108641062445055586465898232206058987213010901916054465984727343586566728534188039586276955267721596438849734782153047453138708884823544103625472167914478659281705038380720108340021535686076555513881607588397751940589726208596699294331232401862583953495806350127928948104944167483613709083186757018093633870762563847995216632187609473531916444535387353593649111542887783568301103901340106081099890451032505447614648365009964875584015039640843655297247107364053485654009415846484544678486622551225783457953056820371201925548685608012108435183395361450326696262252053596413307214350722026395117123155123394944444042399958228964564068287710509487572238362562073996621184832592490828343588195038304799254734871054655257638558976912734569454489793454748656373856497534709996933843731957787542847386149228988564533599714251480861340810597117408662856490972050834402552110459860762430328665017122354919500012561998851854252479013091794069892243044076082861095819644401482244962435906748119139146575159579943065496758031621511183663896035986585282698477481654595269636013493889042486284751169985065026813861397268572638177345942206438311029449912177257033915603951370695694756868648397368041040786975643746889096143616914307685122993686998757414818355675628638013689244990620734700914701976157614147173773178250737224003680233434671032510560806760674768401502244536752165296464359462226998436686424788178613764569697847281539454209764134036287529322338632805070136432426760168848252878156980429891859786652793587"));
            primes.Add(BigInteger.Parse("441295672708363689890744553776433764566842621273095031559878144591347016535710150268276152629941438161404736666152857485331499507563066017513285953810709702505436287754922797252645884291480748757463866937074241394902659682427131686035890149572905719376354663816636144925430890975190453426248516678699666571850243004770166533712485893935423272332411450356125590732885710522425015502327377449731789037888387698830210317026832202196909714640619790806742897324006654322908848800280076589091848480965470497726293779532118919388171082207451767676891993931061118260016621481498567790967734554981831929184153398726460679560762279458060112738439348641649159738507418159045663387306882156154212458763718780525511453432884404267792452400456193524845948027307219570501983641977926712473629359989567702739854321113853633485912807626435401354922529460214830833432641702586016542885845991982747668849911090841299836342146116605514332939633414671691808991419174278529519375161290834563980040480320360095487269453331677120648910836826721807753816849334875886315124292948341747995405157918116543367109695297672049699747849252873244155311841812297626709719188692144166131685943356463158909047316111222471724728278669495289046745089527702436696205056888888178019668893962285571550581045401870846458909180772497048343839852192114712222649387598594554203747546284309768476161423070986677779391236867298466090970073333518815167899187736098150417566558166009494676141871179675992226637963889377939932103017720298021587324927763560691657853888071736476762890379353642193610586660039953074927764934126041179718618192523026960305937446374085954256243668674200607469411114868165951074668577690444966823088668504650946619990508035407278467066261756232504530904802986524074481844162281532155654785910329398777729802364126113611754079265378139031798135767997122939029582453799060406464512531467916571578786358196268111817974285042289476723128296587661301178648158555588783943133996167185407481505454624771453241361804628143205686456932438806100398612217625805658373256450918839917025805164988470572738155698042963296667328510923740164367171973254081811544756952837680939247560966254600212636638063624730451651119432842026656068421325278832551652726477854402714331300635888653193832190638941880594053432630871420827251612371827481332929776260450827938862766319620969981309969307454489515773722452099036178335695676489681651308350629650631359082455481740946084810526976110291900884395735141880965853"));
            primes.Add(BigInteger.Parse("62567955246312352427601436813165137862985713028537643103674999014232274928612724592232321311080060952109629255322480019408211886199987072045766253273574494597220043992219934768321750583700360466695514687213987271473310032082696881923747115837573573907069285870134456010436738239758452075566541414063771699656165930763405172650627707084295863199238291824851457493012605677674148826516363648151556751739787318583433150780823127494642439994875966775297897176695291836602004197649861594943137837834292584298330821384076435507029706803170120163029097288245428001876031283398570485303477846230757524873258640403898609230383019755027980649084922180970727377528438481522854173810356224780974147783095288067036346292186895062927971289843727248791649272269209937534551401044820669526352730674128646042910792645961850229171903082522843509971271149331608397901335465376050107609143712784374700497694042818412655101240284967292958994803054134530573598946168172336782413613343467598917242440169031603172729625473843137768526147029692519556127672494691673011478961349825869795674436795825393175358445008646362346541772317976556290474715213696144989073395355453753331608640837391820078987377362215318154928575061100671417051363012931009649445727182586278808824635279971178335356147099444337894972377357253805428921420182483721649264275615126845498468926814500575389875439745844432892739128291977474371334322766792263988884980539983693684944499425533050334995501479438282599335071918061273047889752099269634213210782499436784885542040664685038160715616611500616443307472774908822446668323637231379512392591986325514620616927961863870286092840190637142082096696212548379554377238849548975240838133337340771073865483190702587903198812434872736314584174474161585960993023541617151046546060610694311607725292266161431691002934678872399716910426773005203970493377359369838260930503501690304239238392262984676278520442627824614637669793058785803331487581567984985061923810614324522647435432745721911213369112144431220055410344970905714129919648209732893755158451435032794898266848288739371603653430065964966090592950111352470238926073329976791409983694054128951689692681469213107399271565304047843139982184585290185350251104454602950117319378525445788475602754574968402930369606886365954253882928553793186369022463382739416901671297081775897884082799648625665235024241101249145786055183944643623247435859723301439843788555063949709682106090751881583337689763665393135341773149064783657363"));
            primes.Add(BigInteger.Parse("150069211467233789233339605085516490343015869082408281149812703838733006917454401232672161494284056207718930037632010942762248386821932775865579451741159298858419631714887488495853013188828271996580220291301515267998096327866402415770489579415562482382350381652693004407656701325200465965329835870569159527967025917132295660469107745117101671382127892404285226962582328650965019477698841466620807710785542146294627681630229007377470375175794001714268723484390767461340382995863219681215122272285298246446722147241355748000424032070059070115536282258772840811813308899241104823093265855845882495502641727626710569368013633493188229607969939796316630459566601429641266101415833343260040696417867488118101020556216883975895117093521726419893440659425125726480054471464814362877083915530597894904433009373851014968652613767541984676781290999916644835113808071269997913008897349815131188004017409782925285150096904837181035228400047459089166770884223268434119016485080063535767129345420366576086492748690087001338861695999347064070496472584807928023774718929676579788003598275344624888176538898306835113951090443316820931405044938648762648279852046665771780928989385499391038411464913912541659693361021676122099246575881578282608140006476226966164832020220208577987611940928687321146869838392249894647621677670738930716452937719543214407453833239310521638163916695830073168967442414916760878926864975472807331459877296861690698370216844329187442652659487517768496523624837610037627277596852589795050280375337701407250781095863743191281972984386036643991329144894512766611951895079580943141859202159066517979403498651731068996501624935800583143002385613688943045041059242533050537715050897052041594406666626268037855574233212062283528959660214081436273086432724272636148902909220696176225692910961716702150194380671951450494348966809528226385030476061989984139528618471132056273768827737392959312222076781170591878557016227134226549095233454986406853187263506282137823743659312989998432852552398463619650700242021190358886228331610093212652769002615941281961419229816328883474780301538928530256657250375628433331872766101032886371192065841041570756760919291547797728526294379591030847952618902675038990205427804283614347429944607183038700711510586233571652351705123825859676691989173584638087369196163796789641510071424060576319390986770396999159376220411580439655040526137061016149616510733082582703725034275487742701572869822547541736941812933785654311544193127659799023"));
            primes.Add(BigInteger.Parse("150680714457840480696278928362231012213714066531348211192860176556299342393961898367213432850009582823754358480885796371174501704464876103234521293394590548250231479527744864541577610820613606711064513735936590716581350071793054791276124366384872265728908242221795794505806624134150210895260400614412456100901006604884712154137652272380062988237467224418157528846980323336885160434349506015547539699536579538906146413051104138824745326099983023728026477284911193205348434509535778259002432342617469517410150165273171667206936163395824070338987493759152189216906927835334290748253935405021865175273757252286961140333667555377630535418764742458265682566284089498133463893655507398192426272194322209038165115902273998392804265898290857219806601971110606788210286792166426172344564555789491971347043492648840719163370308976164618150431821539732557695826027793495212062888782289634888748750664904105214874651548930728204126778211937424286892388959663629209243405183452679185953106460113647925785161146578703189656866337859827562815608518516842208618228295010174431181466965867087238273206210514446533148314748425064136308794583813264764115916238610141542354973815258811527586319810102157032118091253725944931119987297446183883393780065492221428723124072179283032927537202823025405277415556902591068593224129382653160774976309082981081953303787788809914369540773900800235487703679528382699967922958217708420145789294891141768261920254829125544528112017770436164253829922279244099011678224290600262980470894609009243459751686870726942917682369879827527517192777858089206610472259789361020088369709789184359726093463672270777659100886384582540941078638751567741174902602532861815477910093899001601160380934496581165401173063462704156906951758829834632957492147960426827646315219356825333459244757625869460463079139730220806532124945795220099375322294125508607947666634267469095699095241915642332700757562982888411824063691676475759998872381200702428658999184579478421700867757649591290954419335236094330383240611340328764600054418723251960100271429588327185647433422189974653493602008565287716180183306736462051699109879828753448406710347237411990933611203452048736532979442105104158987514622824808151509331899496586312328750468520880961341841036804870184115358127268040798940682146243015657738662295505135784911144385886784246169040698130428126885467636778931636376211315195419416349414661384393301672833153699625104845443877296187537755364113370378159243376308801394217621"));
            primes.Add(BigInteger.Parse("182334033304762566366255726356929309791238391958713649011410205508864730309508939933456992720749055362510165769273316010697871066735589934880662595805324970944435856347811210011537650262818942749674835872343430630805447812426837909656572405585045260258343947152269811180365195952765304891819401685718977727765991876448106973334264703330405223286204967059261505120431370629270071599117455537061136400700234884931723811846580252890234601217143482651537588259738875660820960938548430918132674210383389966053665459495873072502351919866904809869956705318402219472814703112984987605448543307973817472624740251956274702891617790027650881076195159228272173197229068724139967255999970437584697365576662283872582586401360207048246040750334349150671680897198310061522885671063023762686929961998821683082285279075464899774454678657777174317932962751394770771262192302127393030419659499321302441182160664093365775530962649403175537529296333029257696006346392447780717999100406813967221135053132810406603541522789503724028844043941487214530028205337265647774384411317162712343205818562878362741425694473173364538264808757409650558421677489995574648244975294209123903855106515096245778138582588730270655077835894145993933821546031022432798660955236272073753919026541224619664213882719802177301621615866768460477810746133234963403620766192686019239036948070597574049158075715493928314056756374172453692341481504420789343065584448558412026043259341914292300684824376200652616614458290334973569328955963312914451146275484308011065952312359057802187623267305862510667903931280776848629754686629285409830300634563447186372020034319355461330104072974472529790090324853703945877977424371811080096080159421373468172291739549818807403779054390449740575409639876575924344821196439223984426827151376356316700481501604246674688101126026936178746472634499586591214620184038529191660229866797982980563073851722883457205359635034385767160883342456064430364506853674911193448952897582263092298161804847355600357469661156782215599342801090961885975504792034762507964612107037157211656883774656882398039199938309527400875522622465871308633561744408257982997872130034641160058873044472211715881715479580798453190428486266990465853748358512261737062145474591553534627491570649264560393548109214634360079754020346532544259271515675453143919249589859996272060953181282113286432975566381277186362448353584006044522994443578920184557020103785387660868475029393286398594857926726837467225127377034706411709"));
            primes.Add(BigInteger.Parse("376254341489820362824121387730875249665103275936039273918059841455309589484175714101468366949555055394245442203625679970206560529320320860803783117516903199156634312781216351511450362585459923004144900093620323682533693548317523234703017278230167944667154204784514904887014239563890000399584801225434083326400831670877797846982375375102178252650844252239246088350537755334764694695861808077487384813531701132675872555779082904483251331137041729828614791795900597585761166425577153666514250353340719568097036021889178726256361301841810910165614180285799251414840616066761458137062283597419946672773885916723483563199831133307836340525034135966469196472206840498232628881868951047064345292338705874993215918164983073309221714984076411391414103137663939966567348241371221233241958194803028080989258895417881118591449153639126643865064699137674461390346377490957517255849918172661639650728620509442541748105185170529115565564433584172937582629523694852699874407169018483006458089607073431331268743783173502250856522591965064801041083384525570629318257877708728276801938551172088650054585349273689469847905319319079985609352769587619413840019545243607897626459135446533941087079078579115944859474064668475305964831374149877334643251398357575316173726075631561103360896021141953119768351394294337097811420316237372159909887242778848842986096119467789802450920568556610880438562136888403258013101917290223696218373745332266731852872311222262060907546850351617098926452279857101519893476196263489803249686932528983617591815513037481949680648734021167613758267521091259002453586692693343557143301458604204200479636276135433957027358833097409014142068710342795056978485709895359048101612938777365432957781303072288981686004066407104857518557974494621068449304488713104102143073747871827129152330300619451514916455166471766634980871003450921771018583386200370203152570846645804562117496086585402051096091384903281478160001999660371775206782583738181035389864666183477443557188377069536541311911009019804306680648504152018990704823432350524973910683502519500934403538201496849354717342804826768900177499527022823094361515056541629575096324513233989852525626682292689583333367461299035087383792666471456507394241353624633659123340632383868798602162796115600970719581935550595704346782349299157495170488237505571015983350711264700139597238248033584176666208263007292899489271722659344812046183046708521593927385051152802650200868223465839566855879733033023461293355757479631317763"));
            primes.Add(BigInteger.Parse("491618104914936799865561758177968615044814873839740191254267719593250053679349676292114901319481488374773407001160373180682896418444782723769724896685938360992860411871916327964422166991279808970509695632341949937687428561010288715915506827352564123926273664035727919574879782618773661365469542786650826851396502687461482060586568087943236109764289952308430078360903125188439208128001674731707464782638386150160720969469424109757636123464009752605920574813082929808786868881873598806217275404149389317835044652191738707004157125292930728909497870107799863688839386970607934271333155243078766772586457833495122162643574178077262717284198435505810215077559368913495564013263851278278508190968967450924274439142963132170803897319210507625838411105401368462852665314093589941162357841056587253209481469366148181480797350627055028142037002241816971130417079345458936246422868130803431681646759816222483352742541445561468300438733784501904425276717668970045994237727008199241677122511030781481343724204761472298302783358066747604819689200178804754418713340393020575706010727635168866095942879014992516657934100645025531434569600885786416308268164279176094347394491996224532592016872969742369813239477990988422650338656715258710958952036150447777333869039277002653784355168471320865258865817986601337350246474609980810307614520210173368668561015010556937897165644014754095700806389999906782822508346261359302334165103207634858230665627215594053672016275474976585439102514878437228221003249254669137390120415203241784821572337542011284660263859079006681603113758816493517171849261769598136554401372785376628825376856187908582142780956222768698768838072570660732361753801946363870361679136625456456911709981134005189996114800125433614286395452032325529415896078375957883153786816546064864164070798855794986270788539408704389676166816481919654551189641562631084243745255872638319704398853282037304071208474839405545505706165840524681192862577271234772439812068782057817966373797625180135473336815273472657426955073739776245599006471568605932753012559091318062269962674856833520616295948666684224673810419126867428065275966369358270719628944132117580253000824672772363381163377280564197307416665007123354656308890623821851062715766579166942373352758329856454751461732589246566584997868112013313440630085914365681353239742023553502019852710484852544826757392038460784880641598708178504904405287449054239883175909918563604481509139931392239146985310724161156340980259446986864137"));
            primes.Add(BigInteger.Parse("410790978310095295798179846380399459409769685920714072999954557203626782331338667610862384360927788480017487856956812988757027386388397114627541688235503083179796746136477619141605250020334053306935467724560403490634104067579413692791000351767026065133927836629024977880324059285889606743931127523027747358185542815383294369233953473426615856916847817568469478112265565423884285309780646120636037502157373185538521842934446570027361200460750993327372032182266514733096513335487470040614562265786136141428499275670206227512770101451634973388706148757583411682219498445503905304561914042576073340190080155448170449833900808100339185771837943827266468222012030020588123677918251133580911688467387102112838666301641311868777738658780046261293827411105950715236630651949191412284633436520612693769820113325628503409914862630845345961774797630200104620020131590795513693198077416815058576380627735877401365052981420837652154452816032987517143034738579752358175172404162359661919118402721680770484789304479439742878159706865247964374055318732794296503556522071821846844075514831793782392980334313783512935187703431716582999334534508940239005879157778239878078050920270279301651467271571483722137507465584239080654512255871142128662227574533839946690796332329855300763339536270120765563026703196513058912287046312882842240264957685415935971078119385228663634763146728012417416552456481878088330402447085498313944981738745553273165981959789495239352241997788558640698878604170010197877437176650656109039073458556484631456728743103359482519406227175988009238869503599647340111438508163415335395628159970076987794167267088744142087762416032313608135029450767784179674498302927701548371502093615438728413402171555258781633690219474159559208831055888884985750285313228303202712907066400577213157532640771811494319218257347581188053704320520238544888865599488773158869214375624358722264694072552680321736142698820631742624370377721789702022611891501082577480233844493208111928036950748917503644838222320683154243665609096615523661050349439840484188172220247746414928039719227527409646781933021485303450931249951323887100763371515931592194616716224220484348886996471245612140669553665256268331365374955996100736888972367172041872196162976444549690664291695066632442632625023828276250227981156487234506326963813046961154135800532565080913848283497141451631569985061645394347696257521655074124643730473587657740482387727256492317105348452975159072049894166468897030179786970527410827"));
            primes.Add(BigInteger.Parse("498035196970114807222176243578122165917062333063702418875693880649809870901933429035549125865072656946557090418217654202453976924803031568301486018755877087513085011845696896497407517718840516611635389163433427475529182232260588624295038968422025602047593742590251199667530423077357890811939027147227465780525138901854537302533295331227567737516832768725300292019959351832322185402273586373207745971726342567921632260038903608484897362175290586838302911989520915044869946698785040340936814009001736941932276615770184626623042082628158285873349013191362377174664272911979957083360421422931399099341996627548736129413172179487974118040750094758908503219132550976288241970404023623200155196870178971501138603081193296282861670642549460968651328610041427493611468124562586137421533694824289692088225526251531099592404637438624609998497192510618028102007211482501579499512985556102548991358257402536541597068747184869837727112506958525270269439719617572214319460323448384679850188707213518839106497284172691646398177843721991565813365799332042511080348079260901049921915883051670921324951653344359347810198485706003436477390996478158243518609530954511058752670405091259353917461596838642345539155829266719256537389515591004999418170553853547615127592642224275888673666029074796889462025383890643564551697604905489388195556043285039641128461665703529312270179157012685532702915085647530210638977159818705475469056084672577507982181290855442126057637938114834626768086324053774882744794590049547303105598186373803476477832141190738681413669265947841095226758967350366942057261443647920529223872435771053994558417390916094945513283747655941084707107824023113830829483569769276997522202140447070542729041353680755960685006950043346975199923048070431420824540662254018080569471361356647076961179222330337500845041642803985266687841544368641101780149478100077557366095134366091689374247167544217160424629700321711898511252230440805841660492597859228919251992909355070900218520166061873695889921129149073649686590883133646319173575687605387997111905562110190238518605096369453989639561128139758970239332823972032830051899809092752748426150426565693301695721812475708764142005020262747022960219757401780662580407034924503315879414425287596124694773468679043684006849091187696594735288174293293421977700500792984043269374395820766885736969379041463140642360036570933958604445674421720787156524295907270066590718256427365254568073702329186023420018605579831474019085919151302607647"));
            primes.Add(BigInteger.Parse("16448153454035366841057869958808293962952750144823157290346623916834107167324278627871177414957308098760452965146140136948883003934747198771147535839851774759941564335152153538580444917085073615346545240472884873784128672051850660070268965905210340053425315370182032355000304352685734230877100359095378398622330166018897063967283647984358392377060023271792363247181308606705436318906566313219507588664726320352655040391914341171785552344903484989701200916358048313198295239268251198844602208593199153446126344257599254933721004659632816151109259188139499208263331977683073691049078180874523388501713274805558959166880480680278768439435167766696816332834896653891851885229317055007141672463560477918050087400590588866114401915424885031254886194030718930119444457568797370326042306360190845190342326829612522278472108084217187759140859473059482719533976129128695474482411575786609968577570100672506858674488259920510686325236930486036942669614689886151188624622382643661748572593991734079285425955718867892748889977357673251106733244468214645341915354771279678489762522553273751124744956176036882709651043397630591819778152531147919449135274411283957635002809328763861335922140996675966821764525621948326403411315913888276824948095879310664801677883987506355234621557983345979190510926668425694784582837185731718014586085990608216282633165951187922091224019739208210699153239018182840442640118527066090011801024917563257310772654480899530129443792491894158951761808052822036001110651356462928073428598002109259240638916749615567274352073776749242365944898990947251187501850652548832901377678113132126171627867344052527704437705423256020323867694842475956466736155617985338589385414015220086833495004869552084544267896472297155069335257567262949911989179748347480265405372042377162322936815173198572716557187781729340594078652031727611889676283952192037084207726910205974509444337308308561280329627553504985985369590442468709406314409508931006092030133607715639822311373775917334486184608712215321263020112059729071852849308205000251045164129562610941381139170015401861496065910613906447376376382075480651559662163644457242075794521845657585958643077176917915313710463922438991562457885405870560290502666862513234176265117176601751393252716057754526048659666705520171940141864081056996843892739198085516598059901885890441193411619678351206123628497547934324068457836228687324912826951559769966447635029453185764440928409464142374916409832550341791018740156901974492903"));
            primes.Add(BigInteger.Parse("305031125278369057721838647622416183650259520121707548373169384136622618952039861509988579262701510025430756978154550865926054264806738837268793910205184704219619973949625984806173642942304592830307212859401235870050717616515695445694067709675913475869397264502617173146411001481977796789350961667641479385184585024250136215136688332790296284407442208254681323418073472915661380098201460161220498163721464217956246613714126355279214166996663202386957376250321706662429982730660135011792488575620303416824616778791825612834290395659022624121153240052732284878817850360181694298949163373343573475110945460141180655231738668052699157285025816797009049115624350882731424524585472684454691312290299831041726337387720199981836093281188434473717224582213798885810472173610177389691732531051957521583925112432991174918121866612240901339006801663193900085871233388801687286329726316112917448639170902675510666015384729517707107245706762714065268038989949872489479328104349348309928817600633703259380469637589650153262539333033794440763327485722970309316360210448970114234184156985748237067812364666629590774522533703066597651710895853877991029400227493445703657402878321845539418911845292114902815573359603322137166301103404617859923779344291572413007198342352570403253913946041760141253212640591310725304932845997825280555185431806836817546871505238102323491248729864647871953673540610552870922342545057974244590851669742997027209741300424796020987950696311684713727831634700467363588844678240606107129499255662704221617579753982792469870683502047841730533273181985890104858502863853120179054527489451334322434292582940967073041913006531970336769780980450968945627465433561512001476463603682294025077140683481359755696645674160632927659974970372656846278036141883954498888499983687090026680252333475647757574105245114615214105943132162629364998389842682476483843621265228953945800386702946100427298043392945954131871907246271002262309476326602265499386230409552542232837479522340620927426859409804846787358098245894915648218437680695540936109086827866248552337014577661672782514885806739617695276698847453977487839129163019666736239651799118006175211722802732556239869292468063495450129237258029911976087561033874754700719534779460599579514456453302762159310412829892839899343474503347903710549609754063851464682415725133242976196595744113829078806955487058800076128186198820924457845911264054034819104694555166219859264226796352750795186486265887634651600976288696405655459"));
        }

        public BigInteger GetBigInteger()
        {
            rng.NextBytes(buff);
            return new BigInteger(buff);
        }

        public BigInteger GetBigInteger(int length)
        {
            byte[] arr = new byte[length];
            rng.NextBytes(arr);
            return new BigInteger(arr);
        }

        public BigInteger GetPrimeBigInteger()
        {
            BigInteger i = GetBigInteger();
            Stopwatch sw = Stopwatch.StartNew();
            Stopwatch gsw = Stopwatch.StartNew();
            UInt64 iter = 0;

            while (!IsPrime(i) || !(BigInteger.Parse(i.ToString()).GetByteCount() == BITE_LENGTH))
            {
                if (iter % 1000 == 0)
                {
                    sw.Stop();
                    Console.WriteLine("[" + (sw.ElapsedMilliseconds / 1000).ToString() + "s] IsPrime() --> " + IsPrime(i) + " --> changing number...");
                    sw.Reset();
                    sw.Start();
                }
                i = GetBigInteger();
                iter++;
            }

            gsw.Stop();
            Console.WriteLine(gsw.ElapsedMilliseconds / 1000 + "s -- total search time");

            return i;
        }

        public bool IsPrime(BigInteger prime) => IsProbablePrime(prime, TEST_SAMPLES);

        /// <summary>
        /// Тест Миллера-Рабина на простоту числа. Производится k раундов проверки числа n на простоту.
        /// </summary>
        public bool IsProbablePrime(BigInteger n, int k)
        {
            // если n == 2 или n == 3 - эти числа простые, возвращаем true
            if (n == 2 || n == 3)
                return true;

            // если n < 2 или n четное - возвращаем false
            if (n < 2 || n % 2 == 0)
                return false;

            // представим n − 1 в виде (2^s)·t, где t нечётно, это можно сделать последовательным делением n - 1 на 2
            BigInteger t = n - 1;

            int s = 0;

            while (t % 2 == 0)
            {
                t /= 2;
                s += 1;
            }

            // повторить k раз
            for (int i = 0; i < k; i++)
            {
                // выберем случайное целое число a в отрезке [2, n − 2]
                

                byte[] _a = new byte[n.ToByteArray().LongLength];

                BigInteger a;

                do
                {
                    rng.NextBytes(_a);
                    a = new BigInteger(_a);
                }
                while (a < 2 || a >= n - 2);

                // x ← a^t mod n, вычислим с помощью возведения в степень по модулю
                BigInteger x = BigInteger.ModPow(a, t, n);

                // если x == 1 или x == n − 1, то перейти на следующую итерацию цикла
                if (x == 1 || x == n - 1)
                    continue;

                // повторить s − 1 раз
                for (int r = 1; r < s; r++)
                {
                    // x ← x^2 mod n
                    x = BigInteger.ModPow(x, 2, n);

                    // если x == 1, то вернуть "составное"
                    if (x == 1)
                        return false;

                    // если x == n − 1, то перейти на следующую итерацию внешнего цикла
                    if (x == n - 1)
                        break;
                }

                if (x != n - 1)
                    return false;
            }

            // вернуть "вероятно простое"
            return true;
        }

        public Tuple<BigInteger, BigInteger> GetPrimePair() => new Tuple<BigInteger, BigInteger>
                                                                   (primes[Convert.ToInt32(rng.NextInt64() % primes.Count)],
                                                                    primes[Convert.ToInt32(rng.NextInt64() % primes.Count)]);
    }
}
